(function(a){a.promise=function(b){var c=[],f="resolve",e="reject",d=function(i,h,g){try{if(c.length&&typeof(cb=c.shift()[i])=="function"&&(g=cb.apply(h,g))){d(f,h,[g])}}catch(j){[].unshift.call(g,j);d(e,h,g)}};if(typeof b=="function"){b=b()}b=typeof b=="object"?b:{};[f,e,"then"].forEach(function(h,g){Object.defineProperty(b,h,{value:g==2?function(j,i){c.push({resolve:j,reject:i});return this}:function(){d(h,this,arguments)},enumerable:false,writable:false,configurable:false})});return b}})(window.promise=window.promise||{});